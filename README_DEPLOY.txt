
【MES 系統部署指南】

請依照以下步驟將系統部署到新的公用電腦/伺服器上。

=== 準備工作（在新電腦上執行） ===

1. 安裝 Python：
   - 請下載並安裝 Python (建議版本 3.10 或以上)
   - 下載網址：https://www.python.org/downloads/
   -注意：安裝時務必勾選 "Add Python to PATH" (將 Python 加入環境變數)

=== 檔案複製 ===

2. 複製程式：
   - 將整個 `mes` 資料夾（包含 run.py, app 資料夾等所有檔案）複製到新電腦的硬碟中（例如 C:\mes 或 D:\mes）。
   - 請確保該電腦可以讀取到 Excel 檔案路徑（如 config.py 或程式中指定的 D:\ 槽位路徑），如果新電腦沒有 D 槽，可能需要修改設定或建立對應資料夾。

=== 安裝依賴套件 ===

3. 開啟指令視窗 (CMD)：
   - 按 Win + R，輸入 "cmd"，按 Enter。
   - 使用 cd 指令切換到程式資料夾，例如：
     cd C:\mes

4. 安裝必要套件：
   - 在指令視窗中輸入以下指令並執行：
     pip install -r requirements.txt

=== 啟動系統 ===

5. 執行伺服器：
   - 輸入以下指令：
     python run.py

   - 如果看到 "Local URL: http://...:5010"，代表啟動成功！
   - 請記下 "LAN URL" 後面的 IP 位址（例如 192.168.20.xxx），這就是大家以後要連的網址。

6. 防火牆設定 (重要！)：
   - 如果別台電腦連不上，請檢查新電腦的 Windows 防火牆。
   - 進入「允許應用程式通過 Windows 防火牆」，確認 "Python" 的 "公用" 和 "私人" 都有打勾。

=== (進階) 設定開機自動啟動 ===

如果您希望電腦重開機後程式自動跑起來：
1. 在 mes 資料夾中，找到 `start_server.bat` (稍後我會幫您建立這個檔案)。
2. 對它按右鍵 -> 傳送到 -> 桌面 (建立捷徑)。
3. 按 Win + R，輸入 `shell:startup`，會打開一個資料夾。
4. 將剛剛的捷徑拖進這個資料夾。
5. 完成！下次開機就會自動啟動了。
